{"ast":null,"code":"import _asyncToGenerator from \"G:/Estudos/Angular/Orcamentador/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { EventEmitter } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nfunction PhotoUploaderComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 5);\n    i0.ɵɵelement(1, \"img\", 6);\n    i0.ɵɵelementStart(2, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function PhotoUploaderComponent_div_1_Template_button_click_2_listener() {\n      const i_r2 = i0.ɵɵrestoreView(_r1).index;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.removeAt(i_r2));\n    });\n    i0.ɵɵtext(3, \"\\u00D7\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const i_r2 = ctx.index;\n    i0.ɵɵadvance();\n    i0.ɵɵpropertyInterpolate1(\"alt\", \"foto \", i_r2 + 1, \"\");\n  }\n}\nexport class PhotoUploaderComponent {\n  constructor() {\n    this.value = [];\n    this.max = 5;\n    this.valueChange = new EventEmitter();\n  }\n  onFileChange(ev) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const input = ev.target;\n      if (!input.files) return;\n      const files = Array.from(input.files);\n      for (const f of files) {\n        if (_this.value.length >= _this.max) break;\n        if (!/^image\\/(png|jpe?g|webp)$/i.test(f.type)) continue;\n        const dataUrl = yield _this.readAsDataURL(f);\n        _this.value = [..._this.value, dataUrl];\n      }\n      _this.valueChange.emit(_this.value);\n      input.value = '';\n    })();\n  }\n  removeAt(i) {\n    this.value.splice(i, 1);\n    this.valueChange.emit([...this.value]);\n  }\n  clear() {\n    this.value = [];\n    this.valueChange.emit(this.value);\n  }\n  readAsDataURL(file) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = () => resolve(reader.result);\n      reader.onerror = reject;\n      reader.readAsDataURL(file);\n    });\n  }\n  static {\n    this.ɵfac = function PhotoUploaderComponent_Factory(t) {\n      return new (t || PhotoUploaderComponent)();\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: PhotoUploaderComponent,\n      selectors: [[\"app-photo-uploader\"]],\n      inputs: {\n        value: \"value\",\n        max: \"max\"\n      },\n      outputs: {\n        valueChange: \"valueChange\"\n      },\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 8,\n      vars: 4,\n      consts: [[1, \"photos\"], [\"class\", \"photo-wrap\", 4, \"ngFor\", \"ngForOf\"], [1, \"upload\", \"btn\", \"btn-ghost\"], [\"type\", \"file\", \"accept\", \"image/png,image/jpeg,image/webp\", \"multiple\", \"\", 3, \"change\", \"disabled\"], [\"type\", \"button\", 1, \"btn\", \"btn-ghost\", 3, \"click\"], [1, \"photo-wrap\"], [\"ngSrc\", \"p\", 1, \"photo\", 3, \"alt\"], [\"type\", \"button\", 1, \"remove\", \"btn\", \"btn-ghost\", 3, \"click\"]],\n      template: function PhotoUploaderComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0);\n          i0.ɵɵtemplate(1, PhotoUploaderComponent_div_1_Template, 4, 2, \"div\", 1);\n          i0.ɵɵelementStart(2, \"label\", 2)(3, \"input\", 3);\n          i0.ɵɵlistener(\"change\", function PhotoUploaderComponent_Template_input_change_3_listener($event) {\n            return ctx.onFileChange($event);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(4, \"span\");\n          i0.ɵɵtext(5);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(6, \"button\", 4);\n          i0.ɵɵlistener(\"click\", function PhotoUploaderComponent_Template_button_click_6_listener() {\n            return ctx.clear();\n          });\n          i0.ɵɵtext(7, \"Limpar fotos\");\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngForOf\", ctx.value);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"disabled\", ctx.value.length >= ctx.max);\n          i0.ɵɵadvance(2);\n          i0.ɵɵtextInterpolate2(\"Adicionar fotos (\", ctx.value.length, \"/\", ctx.max, \")\");\n        }\n      },\n      dependencies: [CommonModule, i1.NgForOf],\n      styles: [\".photos[_ngcontent-%COMP%] { display:flex; flex-wrap:wrap; gap:12px; }\\n.photo-wrap[_ngcontent-%COMP%] { position: relative; }\\n.photo[_ngcontent-%COMP%] { width:148px; height:148px; object-fit:cover; border-radius:14px; border:1px solid color-mix(in oklab, var(--border) 50%, var(--bg)); }\\n.remove[_ngcontent-%COMP%] { position:absolute; top:-8px; right:-8px; } \\n.upload[_ngcontent-%COMP%] { position: relative; overflow:hidden; }\\n.upload[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] { position:absolute; inset:0; opacity:0; cursor:pointer; }\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9waG90by11cGxvYWRlci9waG90by11cGxvYWRlci5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFVBQVUsWUFBWSxFQUFFLGNBQWMsRUFBRSxRQUFRLEVBQUU7QUFDbEQsY0FBYyxrQkFBa0IsRUFBRTtBQUNsQyxTQUFTLFdBQVcsRUFBRSxZQUFZLEVBQUUsZ0JBQWdCLEVBQUUsa0JBQWtCLEVBQUUsa0VBQWtFLEVBQUU7QUFDOUksVUFBVSxpQkFBaUIsRUFBRSxRQUFRLEVBQUUsVUFBVSxFQUFFO0FBQ25ELFVBQVUsa0JBQWtCLEVBQUUsZUFBZSxFQUFFO0FBQy9DLGdCQUFnQixpQkFBaUIsRUFBRSxPQUFPLEVBQUUsU0FBUyxFQUFFLGNBQWMsRUFBRSIsInNvdXJjZXNDb250ZW50IjpbIi5waG90b3MgeyBkaXNwbGF5OmZsZXg7IGZsZXgtd3JhcDp3cmFwOyBnYXA6MTJweDsgfVxuLnBob3RvLXdyYXAgeyBwb3NpdGlvbjogcmVsYXRpdmU7IH1cbi5waG90byB7IHdpZHRoOjE0OHB4OyBoZWlnaHQ6MTQ4cHg7IG9iamVjdC1maXQ6Y292ZXI7IGJvcmRlci1yYWRpdXM6MTRweDsgYm9yZGVyOjFweCBzb2xpZCBjb2xvci1taXgoaW4gb2tsYWIsIHZhcigtLWJvcmRlcikgNTAlLCB2YXIoLS1iZykpOyB9XG4ucmVtb3ZlIHsgcG9zaXRpb246YWJzb2x1dGU7IHRvcDotOHB4OyByaWdodDotOHB4OyB9IFxuLnVwbG9hZCB7IHBvc2l0aW9uOiByZWxhdGl2ZTsgb3ZlcmZsb3c6aGlkZGVuOyB9XG4udXBsb2FkIGlucHV0IHsgcG9zaXRpb246YWJzb2x1dGU7IGluc2V0OjA7IG9wYWNpdHk6MDsgY3Vyc29yOnBvaW50ZXI7IH0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n    });\n  }\n}","map":{"version":3,"names":["EventEmitter","CommonModule","i0","ɵɵelementStart","ɵɵelement","ɵɵlistener","PhotoUploaderComponent_div_1_Template_button_click_2_listener","i_r2","ɵɵrestoreView","_r1","index","ctx_r2","ɵɵnextContext","ɵɵresetView","removeAt","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵpropertyInterpolate1","PhotoUploaderComponent","constructor","value","max","valueChange","onFileChange","ev","_this","_asyncToGenerator","input","target","files","Array","from","f","length","test","type","dataUrl","readAsDataURL","emit","i","splice","clear","file","Promise","resolve","reject","reader","FileReader","onload","result","onerror","selectors","inputs","outputs","standalone","features","ɵɵStandaloneFeature","decls","vars","consts","template","PhotoUploaderComponent_Template","rf","ctx","ɵɵtemplate","PhotoUploaderComponent_div_1_Template","PhotoUploaderComponent_Template_input_change_3_listener","$event","PhotoUploaderComponent_Template_button_click_6_listener","ɵɵproperty","ɵɵtextInterpolate2","i1","NgForOf","styles"],"sources":["G:\\Estudos\\Angular\\Orcamentador\\src\\app\\components\\photo-uploader\\photo-uploader.component.ts","G:\\Estudos\\Angular\\Orcamentador\\src\\app\\components\\photo-uploader\\photo-uploader.component.html"],"sourcesContent":["import { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\n@Component({\n  selector: 'app-photo-uploader',\n  standalone: true,\n  imports: [CommonModule],\n  templateUrl: './photo-uploader.component.html',\n  styleUrls: ['./photo-uploader.component.css']\n})\nexport class PhotoUploaderComponent {\n  @Input() value: string[] = [];\n  @Input() max = 5;\n  @Output() valueChange = new EventEmitter<string[]>();\n\n  async onFileChange(ev: Event) {\n    const input = ev.target as HTMLInputElement;\n    if (!input.files) return;\n    const files = Array.from(input.files);\n    for (const f of files) {\n      if (this.value.length >= this.max) break;\n      if (!/^image\\/(png|jpe?g|webp)$/i.test(f.type)) continue;\n      const dataUrl = await this.readAsDataURL(f);\n      this.value = [...this.value, dataUrl];\n    }\n    this.valueChange.emit(this.value);\n    input.value = '';\n  }\n\n  removeAt(i: number) {\n    this.value.splice(i,1);\n    this.valueChange.emit([...this.value]);\n  }\n\n  clear() { this.value = []; this.valueChange.emit(this.value); }\n\n  private readAsDataURL(file: File) {\n    return new Promise<string>((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = () => resolve(reader.result as string);\n      reader.onerror = reject;\n      reader.readAsDataURL(file);\n    });\n  }\n}\n","<div class=\"photos\">\n  <div *ngFor=\"let p of value; index as i\" class=\"photo-wrap\">\n    <img class=\"photo\" ngSrc=\"p\" alt=\"foto {{i+1}}\" />\n    <button type=\"button\" class=\"remove btn btn-ghost\" (click)=\"removeAt(i)\">×</button>\n  </div>\n  <label class=\"upload btn btn-ghost\">\n    <input type=\"file\" accept=\"image/png,image/jpeg,image/webp\" (change)=\"onFileChange($event)\" multiple [disabled]=\"value.length>=max\" />\n    <span>Adicionar fotos ({{value.length}}/{{max}})</span>\n  </label>\n  <button type=\"button\" class=\"btn btn-ghost\" (click)=\"clear()\">Limpar fotos</button>\n</div>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}